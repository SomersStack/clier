{"id":"clier-1f5","title":"Add log rotation and signal handling tests","description":"Missing test coverage for: (1) Log file rotation behavior in LogManager when files exceed maxFileSize, (2) Signal handling (SIGTERM/SIGINT) for graceful shutdown in Watcher and CLI commands, (3) Log persistence across multiple runs. These are critical production behaviors that should be validated.","status":"open","priority":3,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T15:46:40.804486+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T15:46:40.804486+08:00"}
{"id":"clier-1ks","title":"Phase 5: Testing \u0026 Example Scenarios","description":"Create example config (lint→build→api pipeline), write E2E tests (full pipeline execution with real PM2, circuit breaker triggering, continue-on-failure behavior, multi-pattern event emission), create documentation in /docs (API reference, configuration guide, example pipelines in /docs/examples/)","status":"closed","priority":2,"issue_type":"task","owner":"olliesomers1@gmail.com","created_at":"2026-01-21T13:06:42.298875+08:00","created_by":"OliverSomers","updated_at":"2026-01-21T14:51:12.034962+08:00","closed_at":"2026-01-21T14:51:12.034962+08:00","close_reason":"Closed","labels":["documentation","e2e-tests","phase5"],"dependencies":[{"issue_id":"clier-1ks","depends_on_id":"clier-f2w","type":"blocks","created_at":"2026-01-21T13:06:57.36844+08:00","created_by":"OliverSomers"}]}
{"id":"clier-1p0","title":"Phase 6: Testing daemon implementation","description":"Unit tests, integration tests, E2E tests for daemon","status":"open","priority":2,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T16:10:32.323597+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T16:10:32.323597+08:00","dependencies":[{"issue_id":"clier-1p0","depends_on_id":"clier-hnv","type":"blocks","created_at":"2026-01-22T16:12:42.939396+08:00","created_by":"Ollie Somers"}]}
{"id":"clier-1ws","title":"Remove PM2 references from documentation","description":"The documentation in docs/README.md still claims Clier is 'PM2-based' throughout, but PM2 was completely removed in commit 2111681. This creates confusion about what Clier actually is. Need to update all docs to describe the native child_process implementation, update architecture diagrams, and clarify the foreground process model vs daemon expectations.","status":"closed","priority":1,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T15:46:25.201266+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T17:11:32.361725+08:00","closed_at":"2026-01-22T17:11:32.361725+08:00","close_reason":"Documentation updated to reflect daemon architecture, all PM2 references removed"}
{"id":"clier-2si","title":"Implement native daemon architecture","status":"closed","priority":0,"issue_type":"feature","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T16:10:21.578042+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T17:10:27.312541+08:00","closed_at":"2026-01-22T17:10:27.312541+08:00","close_reason":"Daemon architecture fully implemented - Phases 1-4 complete with working multi-agent session support"}
{"id":"clier-5lk","title":"Phase 2: PM2 Installer Script","description":"Cross-platform PM2 installer: detect package manager (lockfiles), detect OS (Darwin/macOS/Linux/Windows), install PM2 globally with retry logic and exponential backoff, handle EACCES with helpful guidance (NVM, no sudo), verify installation (pm2 -v, pm2 ping, PATH), comprehensive error handling (network, permissions, package manager not found), write tests with mocked child processes","status":"closed","priority":2,"issue_type":"task","owner":"olliesomers1@gmail.com","created_at":"2026-01-21T13:06:02.062076+08:00","created_by":"OliverSomers","updated_at":"2026-01-21T13:55:58.27238+08:00","closed_at":"2026-01-21T13:55:58.27238+08:00","close_reason":"Closed","labels":["cross-platform","installer","phase2"],"dependencies":[{"issue_id":"clier-5lk","depends_on_id":"clier-izj","type":"blocks","created_at":"2026-01-21T13:06:56.978455+08:00","created_by":"OliverSomers"}]}
{"id":"clier-6pg","title":"CRITICAL: Restore daemon architecture for multi-session agent use","description":"The PM2 removal broke the fundamental use case: multiple short-lived Claude Code agent sessions managing the same pipeline. OLD PM2 BEHAVIOR: (1) 'clier start' started watcher as PM2 daemon, returned immediately (2) PM2 daemon persisted independently (3) Any terminal could run 'clier status/logs/stop' and access the same processes. NEW BROKEN BEHAVIOR: (1) 'clier start' blocks terminal forever (2) All state trapped in that process's memory (3) Other terminals can't access ProcessManager/LogManager instances. SOLUTION NEEDED: Restore daemon mode. Options: (A) Bring back PM2 dependency, (B) Implement native daemon using detached child_process + IPC/socket, (C) Use alternative daemon manager. The native implementation was correct to fix PM2's race condition, but removing daemon persistence was a fatal regression.","status":"closed","priority":0,"issue_type":"bug","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T15:53:07.679681+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T17:10:27.314599+08:00","closed_at":"2026-01-22T17:10:27.314599+08:00","close_reason":"Daemon architecture fully implemented - Phases 1-4 complete with working multi-agent session support"}
{"id":"clier-96o","title":"Add missing CLI integration tests","description":"Test suite has excellent unit (169 tests) and E2E coverage (14 tests), but zero CLI integration tests. Need tests for: clier start, clier stop, clier status, clier logs, clier validate commands. This is important because CLI commands interact with the filesystem, configuration loading, and process lifecycle in ways not covered by component tests.","status":"open","priority":2,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T15:46:35.598369+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T15:46:35.598369+08:00"}
{"id":"clier-a0n","title":"E2E tests timing out (circuit-breaker, pipeline, continue-on-failure)","description":"## Summary\nE2E tests are timing out during test runs, affecting circuit-breaker, pipeline, and continue-on-failure test suites.\n\n## Affected Tests\n- tests/e2e/circuit-breaker.test.ts (3 tests failed)\n- tests/e2e/pipeline.test.ts (3 tests failed)  \n- tests/e2e/continue-on-failure.test.ts (4 tests failed)\n\n## Error Pattern\n```\nTest timed out in 10000ms / 15000ms\nHook timed out in 10000ms\n```\n\n## Test Output\n/private/tmp/claude/-Users-olliesomers-dev-clier/tasks/b6614b5.output\n\n## Likely Cause\nCleanup/teardown issues - processes not being stopped properly, causing afterEach hooks to hang.","status":"closed","priority":2,"issue_type":"bug","owner":"olliesomers@me.com","created_at":"2026-01-23T18:51:22.905112+08:00","created_by":"SomersStack","updated_at":"2026-01-23T19:04:39.288735+08:00","closed_at":"2026-01-23T19:04:39.288735+08:00","close_reason":"Tests are now passing (10/10) - circuit-breaker, pipeline, and continue-on-failure E2E tests complete successfully"}
{"id":"clier-av7","title":"Implement circular dependency detection in Orchestrator","description":"The documentation claims Clier validates circular dependencies in pipeline configuration, and orchestrator.ts has comments about checking for circular dependencies, but the validation in validatePipeline() (lines 96-145) only checks for missing event references, not cycles. Need to implement actual circular dependency detection using graph traversal (e.g., DFS-based cycle detection) to prevent infinite trigger loops.","status":"closed","priority":3,"issue_type":"feature","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T15:46:45.995721+08:00","created_by":"Ollie Somers","updated_at":"2026-02-06T23:02:28.938403+08:00","closed_at":"2026-02-06T23:02:28.938403+08:00","close_reason":"Implemented DFS-based circular dependency detection in Orchestrator.validatePipeline(). Builds event→process mapping, constructs dependency graph, and detects cycles with descriptive error messages showing the cycle path. Added 7 unit tests covering direct cycles, indirect cycles, self-loops, built-in event cycles, and valid DAG non-regression."}
{"id":"clier-azv","title":"Suppress noisy stderr output in service.test.ts error-path tests","description":"## Problem\nWhen running the test suite, tests/unit/cli/service.test.ts produces noisy stderr output for expected error paths. The test output includes lines like:\n\n```\nstderr | tests/unit/cli/service.test.ts \u003e Service Commands \u003e serviceStartCommand \u003e should return error when daemon is not running\n⚠ Clier daemon is not running\n\nstderr | tests/unit/cli/service.test.ts \u003e Service Commands \u003e serviceStartCommand \u003e should handle service not found error\n✗ Process \"my-service\" not found\n\nstderr | tests/unit/cli/service.test.ts \u003e Service Commands \u003e serviceStopCommand \u003e should return error when daemon is not running\n⚠ Clier daemon is not running\n```\n\nThis appears for ~10 test cases across start, stop, restart, add, and remove commands. While the tests all pass correctly, the noisy output makes it harder to spot real failures in CI logs and creates a false impression that something is wrong.\n\n## Suggested fix\nThe tests already spy on console.log (`vi.spyOn(console, 'log')`), but console.error/console.warn are not being suppressed. Add `vi.spyOn(console, 'error').mockImplementation(() =\u003e {})` and `vi.spyOn(console, 'warn').mockImplementation(() =\u003e {})` in the beforeEach, or configure Vitest's `silent` option for these tests.\n\n## Priority rationale\nP3 — Cosmetic issue. Tests pass correctly. But noisy output erodes confidence in CI — developers learn to ignore warnings, which means they'll also ignore real ones.","status":"closed","priority":3,"issue_type":"bug","owner":"olliesomers@me.com","created_at":"2026-02-06T22:31:51.165464+08:00","created_by":"SomersStack","updated_at":"2026-02-06T22:39:15.861867+08:00","closed_at":"2026-02-06T22:39:15.861867+08:00","close_reason":"Added console.error and console.warn mocks to service.test.ts beforeEach, suppressing expected error-path output from printError/printWarning"}
{"id":"clier-c3z","title":"Phase 7: Documentation \u0026 polish","description":"Update docs, add diagrams, troubleshooting guide","status":"open","priority":3,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T16:10:32.424123+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T16:10:32.424123+08:00","dependencies":[{"issue_id":"clier-c3z","depends_on_id":"clier-1p0","type":"blocks","created_at":"2026-01-22T16:12:42.993811+08:00","created_by":"Ollie Somers"}]}
{"id":"clier-c6y","title":"Phase 4: Configuration reload","description":"Implement hot reload in Watcher, update reload command","status":"closed","priority":2,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T16:10:32.121445+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T17:06:03.826368+08:00","closed_at":"2026-01-22T17:06:03.826368+08:00","close_reason":"Phase 4 complete: Configuration reload implemented and working","dependencies":[{"issue_id":"clier-c6y","depends_on_id":"clier-f7d","type":"blocks","created_at":"2026-01-22T16:12:42.831257+08:00","created_by":"Ollie Somers"}]}
{"id":"clier-f2w","title":"Phase 4: CLI Tool Implementation","description":"Build CLI with commands: start (load config, validate with Zod, start watcher, start entry points), stop (stop all processes), status (show running processes), logs \u003cname\u003e (tail logs), reload (reload config without restart), validate (validate schema, fail immediately on error). Implement start logic: read clier-pipeline.json, validate schema, inherit process.env, generate PM2 ecosystem in memory, start watcher first, then entry points. Write integration tests.","status":"closed","priority":2,"issue_type":"task","owner":"olliesomers1@gmail.com","created_at":"2026-01-21T13:06:25.679791+08:00","created_by":"OliverSomers","updated_at":"2026-01-21T14:35:59.753532+08:00","closed_at":"2026-01-21T14:35:59.753532+08:00","close_reason":"Closed","labels":["cli","integration-tests","phase4"],"dependencies":[{"issue_id":"clier-f2w","depends_on_id":"clier-wig","type":"blocks","created_at":"2026-01-21T13:06:57.239158+08:00","created_by":"OliverSomers"}]}
{"id":"clier-f7d","title":"Phase 2: Process management integration","description":"Expose ProcessManager via controller, update start/stop/status commands","status":"closed","priority":1,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T16:10:31.9208+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T17:05:10.398075+08:00","closed_at":"2026-01-22T17:05:10.398075+08:00","close_reason":"Phases 2\u00263 complete: ProcessManager and LogManager integrated with CLI commands","dependencies":[{"issue_id":"clier-f7d","depends_on_id":"clier-vyv","type":"blocks","created_at":"2026-01-22T16:12:42.721528+08:00","created_by":"Ollie Somers"}]}
{"id":"clier-hnv","title":"Phase 5: Robustness \u0026 error handling","description":"Handle stale files, health checks, graceful shutdown, recovery","status":"open","priority":2,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T16:10:32.220534+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T16:10:32.220534+08:00","dependencies":[{"issue_id":"clier-hnv","depends_on_id":"clier-f7d","type":"blocks","created_at":"2026-01-22T16:12:42.884493+08:00","created_by":"Ollie Somers"}]}
{"id":"clier-i1b","title":"Clier: PM2-Based Process Orchestration Framework","status":"closed","priority":2,"issue_type":"task","owner":"olliesomers1@gmail.com","created_at":"2026-01-21T13:05:24.231306+08:00","created_by":"OliverSomers","updated_at":"2026-01-21T15:21:15.200958+08:00","closed_at":"2026-01-21T15:21:15.200958+08:00","close_reason":"Closed","labels":["epic","typescript"]}
{"id":"clier-iad","title":"Phase 6: Production Hardening","description":"Error handling across all modules, structured logging with Winston, performance testing (100+ events/sec), memory leak testing, cross-platform testing (macOS, Linux, Windows), final code review and refinement","status":"closed","priority":2,"issue_type":"task","owner":"olliesomers1@gmail.com","created_at":"2026-01-21T13:06:51.689587+08:00","created_by":"OliverSomers","updated_at":"2026-01-21T15:19:24.099329+08:00","closed_at":"2026-01-21T15:19:24.099329+08:00","close_reason":"Closed","labels":["performance","phase6","production"],"dependencies":[{"issue_id":"clier-iad","depends_on_id":"clier-1ks","type":"blocks","created_at":"2026-01-21T13:06:57.497112+08:00","created_by":"OliverSomers"}]}
{"id":"clier-izj","title":"Phase 1: Project Setup \u0026 Configuration Schema","description":"Initialize TypeScript project with ESM, install dependencies (pm2, zod, bottleneck, opossum, winston, vitest), create Zod schema for clier-pipeline.json config, write TDD tests for schema validation","status":"closed","priority":2,"issue_type":"task","owner":"olliesomers1@gmail.com","created_at":"2026-01-21T13:05:49.970821+08:00","created_by":"OliverSomers","updated_at":"2026-01-21T13:34:50.666361+08:00","closed_at":"2026-01-21T13:34:50.666361+08:00","close_reason":"Closed","labels":["phase1","tdd","typescript"],"dependencies":[{"issue_id":"clier-izj","depends_on_id":"clier-i1b","type":"blocks","created_at":"2026-01-21T13:06:56.84127+08:00","created_by":"OliverSomers"}]}
{"id":"clier-j0g","title":"Replace weak E2E test assertions with real behavioral verification","description":"## Problem\nAll 4 E2E test files (pipeline.test.ts, continue-on-failure.test.ts, multi-pattern.test.ts, circuit-breaker.test.ts) share the same pattern of trivially-weak assertions. Nearly every test ends with:\n\n```typescript\nexpect(watcher).toBeDefined();\n```\n\nThis is always true since `watcher` was assigned on the preceding line. These tests function as smoke tests (verifying nothing crashes) but do NOT verify behavioral correctness.\n\n## Specific examples\n- tests/e2e/pipeline.test.ts line ~94: Test named 'should emit events in correct order' has a comment acknowledging event tracking is 'a bit tricky in E2E' then does NOT actually test event ordering. Assertion is just `expect(watcher).toBeDefined()`.\n- tests/e2e/pipeline.test.ts line ~109: Test named 'should not start dependent processes before trigger' uses a trigger (`manual:trigger`) that will never fire, but the assertion doesn't verify the dependent process remained unstarted.\n- Same pattern in continue-on-failure.test.ts, multi-pattern.test.ts, circuit-breaker.test.ts.\n\n## What real assertions should look like\n1. **Pipeline ordering**: Hook into the EventBus or ProcessManager to capture process start/stop events. Assert that step2 started AFTER step1 emitted its event. Assert that the service was running at the end.\n2. **Continue on failure**: Assert that downstream processes DID execute even after upstream failure when continue_on_failure=true. Assert that they did NOT when continue_on_failure=false.\n3. **Multi-pattern**: Assert that the process triggered by multiple patterns only started after ALL patterns matched, not just one.\n4. **Circuit breaker**: Assert that the circuit opened after the configured failure threshold and that requests were rejected while open.\n\n## Impact\nE2E tests are the last line of defense before production. If they only verify 'no crash' they provide false confidence. A regression that silently breaks event ordering, dependency resolution, or failure handling would pass the entire test suite undetected.\n\n## Priority rationale\nP1 — These tests exist and pass but provide near-zero safety. Fixing them is higher leverage than writing new tests because the test infrastructure (config generation, real process execution, cleanup) is already built. Only the assertions need to be replaced.","status":"in_progress","priority":1,"issue_type":"bug","owner":"olliesomers@me.com","created_at":"2026-02-06T22:31:49.483666+08:00","created_by":"SomersStack","updated_at":"2026-02-06T22:58:15.916058+08:00"}
{"id":"clier-kk0","title":"Phase 3: Log management integration","description":"Expose LogManager via controller, update logs command","status":"closed","priority":1,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T16:10:32.022714+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T17:05:10.409869+08:00","closed_at":"2026-01-22T17:05:10.409869+08:00","close_reason":"Phases 2\u00263 complete: ProcessManager and LogManager integrated with CLI commands","dependencies":[{"issue_id":"clier-kk0","depends_on_id":"clier-vyv","type":"blocks","created_at":"2026-01-22T16:12:42.776798+08:00","created_by":"Ollie Somers"}]}
{"id":"clier-mdz","title":"Update project status and versioning in README","description":"Root README.md states project is in 'Phase 1: Project Setup \u0026 Configuration Schema' with upcoming phases for PM2 installer, core engine, etc. But the project is actually fully functional with 214 passing tests and all features implemented. Version is 0.2.0 but completeness suggests at least 0.5.0. Update README to reflect actual project state and maturity.","status":"open","priority":2,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T15:46:51.194511+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T15:46:51.194511+08:00"}
{"id":"clier-qsz","title":"Investigate reload command functionality","description":"The CLI has a 'clier reload' command (src/cli/commands/reload.ts) inherited from the PM2 implementation. With PM2 removed, there's no daemon to send reload signals to. Need to investigate: (1) Does this command still work? (2) What should reload do in a foreground process model? (3) Should it be removed, repurposed, or does it need a different implementation?","status":"closed","priority":2,"issue_type":"bug","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T15:46:30.403414+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T17:10:30.07295+08:00","closed_at":"2026-01-22T17:10:30.07295+08:00","close_reason":"Reload command now works via daemon IPC - hot reloads configuration without restart"}
{"id":"clier-vyv","title":"Phase 1: Core daemon infrastructure","description":"Implement Daemon class, DaemonServer, DaemonController, DaemonClient, lifecycle management","status":"closed","priority":0,"issue_type":"task","owner":"ollie@aglaiaim.com","created_at":"2026-01-22T16:10:31.818489+08:00","created_by":"Ollie Somers","updated_at":"2026-01-22T16:19:15.292445+08:00","closed_at":"2026-01-22T16:19:15.292445+08:00","close_reason":"Phase 1 complete: Core daemon infrastructure implemented with all IPC components and CLI commands updated"}
{"id":"clier-wig","title":"Phase 3: Core Watcher Service","description":"Build orchestration engine with: PM2 launchBus integration (log:out, log:err, process:event), regex pattern matching on stdout/stderr (emit ALL matching events), event emission (:success on exit 0, :error on stderr, :crashed on crash), pipeline orchestration (track triggers, start dependents via PM2 API, handle continue_on_failure), safety mechanisms (debounce, rate limiting with Bottleneck, circuit breaker with Opossum, webhook via event system), write unit tests mocking PM2 APIs","status":"closed","priority":2,"issue_type":"task","owner":"olliesomers1@gmail.com","created_at":"2026-01-21T13:06:15.253699+08:00","created_by":"OliverSomers","updated_at":"2026-01-21T14:18:32.209286+08:00","closed_at":"2026-01-21T14:18:32.209286+08:00","close_reason":"Closed","labels":["core","orchestration","phase3","tdd"],"dependencies":[{"issue_id":"clier-wig","depends_on_id":"clier-5lk","type":"blocks","created_at":"2026-01-21T13:06:57.109978+08:00","created_by":"OliverSomers"}]}
